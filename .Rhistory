mutate(name = if_else(unique_name == "Oncorhynchus mykiss (species in domain Eukaryota)", "Oncorhynchus mykiss", unique_name))
ll1 <- length_length(return$name)
install.packages("rfishbase")
install.packages("rfishbase")
install.packages("rfishbase")
install.packages("rfishbase")
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
return <- tol_resolve(data$id)
return <- return %>%
mutate(name = if_else(unique_name == "Oncorhynchus mykiss (species in domain Eukaryota)", "Oncorhynchus mykiss", unique_name))
ll1 <- length_length(return$name)
install.packages("rfishbase")
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
return <- tol_resolve(data$id)
return <- return %>%
mutate(name = if_else(unique_name == "Oncorhynchus mykiss (species in domain Eukaryota)", "Oncorhynchus mykiss", unique_name))
ll1 <- length_length(return$name)
View(ll1)
View(ll2)
#many ratios for length available, filter for TL and FL (beach seining), calculate FL ration
#use this value to calculate total length: TL = fl_tl * FL
ll2 <- filter(ll1, Length1 == "TL" & Length2 == "FL" | Length1 == "FL" & Length2 == "TL") %>%
filter(is.na(r2)) %>%
filter(a == 0) %>%
mutate(fork_length = if_else(Length2 == "FL", b, 1/b)) %>%
relocate(fork_length, .after = b) %>%
group_by(Species) %>%
summarise(fl_tl = mean(fork_length))
m1 <- estimate(return$name)
m2 <- m1[c("Species", "a", "b")]
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
traits <- read_rds("Data/2021_09_20/allspec_traits.rds") # need to taxize
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
survey <- readRDS("Data/2021_09_20/derived_data/eDNAandBSsurveys.rds")
traits <- read_rds("Data/2021_09_20/allspec_traits.rds") # need to taxize
traits <- readRDS("Data/2021_09_20/allspec_traits.rds") # need to taxize
survey <- readRDS("Data/2021_09_20/derived_data/eDNAandBSsurveys.rds")
surveyed_spec <- colnames(survey[9:ncol(survey)])
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
traits <- read.csv("Data/2021_09_20/specandgen_traits.csv")
View(traits)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
traits <- read.csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
return <- tol_resolve(data$id)
return <- return %>%
mutate(name = if_else(unique_name == "Oncorhynchus mykiss (species in domain Eukaryota)", "Oncorhynchus mykiss", unique_name))
ll1 <- length_length(return$name)
ll1 <- length_length(return$name)
#many ratios for length available, filter for TL and FL (beach seining), calculate FL ration
#use this value to calculate total length: TL = fl_tl * FL
ll2 <- filter(ll1, Length1 == "TL" & Length2 == "FL" | Length1 == "FL" & Length2 == "TL") %>%
filter(is.na(r2)) %>%
filter(a == 0) %>%
mutate(fork_length = if_else(Length2 == "FL", b, 1/b)) %>%
relocate(fork_length, .after = b) %>%
group_by(Species) %>%
summarise(fl_tl = mean(fork_length))
m1 <- estimate(return$name)
m2 <- m1[c("Species", "a", "b")]
#read in BS length data and taxize species names
#bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
bs_length <- read_csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
#read in BS length data and taxize species names
#bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
traits <- read_csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
traits <- read.csv("Data/2021_09_20/specandgen_traits.csv")
data <- filter(traits, species == "y") %>%
mutate(id = sub("_", " ", id))
return <- tol_resolve(data$id)
return <- return %>%
mutate(name = if_else(unique_name == "Oncorhynchus mykiss (species in domain Eukaryota)", "Oncorhynchus mykiss", unique_name))
ll1 <- length_length(return$name)
#many ratios for length available, filter for TL and FL (beach seining), calculate FL ration
#use this value to calculate total length: TL = fl_tl * FL
ll2 <- filter(ll1, Length1 == "TL" & Length2 == "FL" | Length1 == "FL" & Length2 == "TL") %>%
filter(is.na(r2)) %>%
filter(a == 0) %>%
mutate(fork_length = if_else(Length2 == "FL", b, 1/b)) %>%
relocate(fork_length, .after = b) %>%
group_by(Species) %>%
summarise(fl_tl = mean(fork_length))
m1 <- estimate(return$name)
m2 <- m1[c("Species", "a", "b")]
#read in BS length data and taxize species names
#bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
gt1 <- merge(bs_length)
View(bs_codes)
write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
View(bs_length)
unique(bs_length$species)
bs_length$species <- tolower(bs_length$species)
unique(bs_length$species)
bs_length$species[!bs_length$species %in% bs_codes$species]
bs_length$species[!bs_length$species %in% unique(bs_codes$species)]
bs_length$species[!unique(bs_length$species) %in% bs_codes$species]
u1 <- unique(bs_length$species)
bs_length$species[!u1 %in% bs_codes$species]
u1[!u1 %in% bs_codes$species]
u1[u1 !%in% bs_codes$species]
u1[!u1 %in% bs_codes$species]
u1[u1 %in% !bs_codes$species]
bs_codes$species[!u1 %in% bs_codes$species]
u1[!u1 species%in% bs_codes$query]
u1[!u1 %in% bs_codes$query]
#read in BS length data and taxize species names
#bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
bs_length$species <- tolower(bs_length$species)
u1 <- unique(bs_length$species)
u1[!u1 %in% bs_codes$query]
#read in BS length data and taxize species names
#bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
bs_length$species <- tolower(bs_length$species)
u1 <- unique(bs_length$species)
u1[!u1 %in% bs_codes$query]
library(readxl)
#read in BS length data and taxize species names
bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
#read in BS length data and taxize species names
bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
#read in BS length data and taxize species names
bs_length <- read_xls("Data/2021_09_20/bs_data/FABSMasterData.xlsx", sheet = "length")
#read in BS length data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
bs_length$species <- tolower(bs_length$species)
u1 <- unique(bs_length$species)
u1[!u1 %in% bs_codes$query]
#read in BS length data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
bs_length$species <- tolower(bs_length$species)
u1 <- unique(bs_length$species)
u1[!u1 %in% bs_codes$query]
gt1 <- merge(bs_length)
#read in BS length data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
bs_length$species <- tolower(bs_length$species)
u1 <- unique(bs_length$species)
u1[!u1 %in% bs_codes$query]
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read_csv("Data/2021_09_20/derived_data/names_for_length.csv")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length.csv")
View(bs_codes)
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv")
View(bs_codes)
View(bs_codes)
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv") %>%
select(c("species", "query"))
View(bs_codes)
View(bs_length)
#read in BS length data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv")
bs_abund<- read.csv("Data/2021_09_20/bs_data/bs_abund.csv")
bs_abund$species <- tolower(bs_abund$species)
u1 <- unique(bs_abund$species)
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abund.csv")
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
#bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv") %>%
select(c("species", "query"))
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
bs_length$species <- tolower(bs_length$species)
u1 <- unique(bs_length$species)
bs_abund$species <- tolower(bs_abund$species)
u1 <- unique(bs_abund$species)
u1[!u1 %in% bs_abund$species]
u1[u1 %in% bs_abund$species]
View(bs_abund)
View(bs_codes)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species")
View(bs_length)
gt1 <- merge(bs_length, bs_codes, by = "query")
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = T)
View(gt1)
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
View(gt1)
View(bs_codes)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species")
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
#bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv") %>%
select(c("species", "query"))
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
View(gt1)
View(bs_codes)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species") %>%
mutate(query = tolower("query"))
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
View(gt1)
View(bs_length)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" == "species") %>%
mutate(query = tolower(query))
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" == "species") #%>%
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species") #%>%
View(bs_length)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species") %>%
mutate(query = tolower(query))
View(bs_length)
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
View(gt1)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species") %>%
mutate(query = tolower(query))
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
#bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv") %>%
select(c("species", "query"))
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
View(gt1)
View(gt1)
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
View(gt1)
length(unique(bs_codes))
length(unique(bs_codes$query))
View(bs_codes)
View(bs_codes)
count(unique(bs_codes$query))
length(unique(bs_codes$query))
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species") %>%
mutate(query = tolower(query))
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
#bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv") %>%
select(c("species", "query"))
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
length(unique(bs_codes$query))
View(bs_codes)
#read in BS length and abundance data and taxize species names
bs_length <- read.csv("Data/2021_09_20/bs_data/bs_lengths.csv") %>%
rename("query" = "species") %>%
mutate(query = tolower(query))
bs_abund <- read.csv("Data/2021_09_20/bs_data/bs_abundance.csv")
#bs_codes <- read_rds("Data/2021_09_20/derived_data/taxa_bs_resolved.rds")
#write_csv(bs_codes, "Data/2021_09_20/derived_data/names_for_length.csv")
#replace query with closest relative (only for weight estimates)
bs_codes <- read.csv("Data/2021_09_20/derived_data/names_for_length_1.csv") %>%
select(c("species", "query"))
gt1 <- merge(bs_length, bs_codes, by = "query", all.x = TRUE, all.y = FALSE)
length(unique(bs_codes$query))
View(m2)
View(ll2)
View(m2)
View(ll2)
View(m2)
View(ll2)
spec <- unique(gt1$species)
spec[!spec %in% ll2$Species]
View(ll2)
ll1 <- length_length(return$name)
View(ll1)
length_length("Syngnathus leptorhynchus")
survey <- readRDS("Data/2021_09_20/derived_data/eDNAandBSsurveys.rds")
View(survey)
library(tidyverse)
s1 <- survey %>%
select(site,date)
View(s1)
s1 <- survey %>%
select(site,hakai_link_date)
View(s1)
s1 <- survey %>%
select(site,hakai_link_date) %>%
distinct()
View(s1)
s1 <- survey %>%
select(site,hakai_link_date) %>%
distinct() %>%
group_by(site) %>%
summarise(count = length(site))
View(s1)
View(s1)
#Packages ####
library(tidyverse)
library(here)
library(vegan)
library(usedist)
#read data ####
asv_matrix <- read.table("Data/2021_09_20/sequence_table.12S.merged.w_ASV_names.length_var.merged_dataset.txt",
header = T)
View(asv_matrix)
s2 <- asv_matrix[2:ncol(asv_matrix)]
View(s2)
sum(s2)
ASVbysite <- readRDS("Data/2021_09_20/derived_data/data12se_asvmatrix_lor_12s.rds")
View(ASVbysite)
s3 <- read_rds("pooled_asvMatrix.rds")
s3 <- read_rds("Data/2021_09_20/derived_data/pooled_asvMatrix.rds")
View(s3)
sitesurvey_data <- readRDS("Data/2021_09_20/derived_data/sitesurvey_data.rds")
View(sitesurvey_data)
s4 <- sitesurvey_data[c("survey_ID", "hakai_project")]
s4 <- sitesurvey_data[c("surveyID", "hakai_project")]
View(s3)
s5 <- merge(s4,s3, by = surveyID, all.x = T, all.y = F)
View(s4)
View(s3)
s5 <- merge(s4,s3, by = 'surveyID', all.x = T, all.y = F)
View(s5)
s6 <- filter(s5, hakai_project == "beach_seining")
View(s6)
View(s5)
s6 <- filter(s5, hakai_project == "beach_seine")
View(s6)
s7 <- asv_matrix[3:ncol(asv_matrix)]
sum(s7)
s7[, colSums(s7 != 0) > 0]
s8 <- s7[, colSums(s7 != 0) > 0]
View(s8)
colSums(s7)
t1<- colSums(s7)
t1<- as.data.frame(colSums(s7))
View(t1)
taxa <- read.delim("Data/2021_09_20/taxonomy_table.12S.NCBI_NT.96sim.txt",
h=TRUE,
fill = TRUE)
View(taxa)
#Packages ####
library(tidyverse)
library(here)
library(vegan)
library(usedist)
#read data ####
asv_matrix <- read.table("Data/2021_09_20/sequence_table.12S.merged.w_ASV_names.length_var.merged_dataset.txt",
header = T)
sample_data <- read_csv("Data/2021_09_20/Calvert_12S_metadata_manualmods.csv")
taxa <- read.delim("Data/2021_09_20/taxonomy_table.12S.NCBI_NT.96sim.txt",
h=TRUE,
fill = TRUE)
#formatting and partitioning ####
#rename columns
colnames(sample_data) <- c("SampleID_rep", "sample_ID", "PCR_rep", "sample_type", "location", "hakai_project", "date",
"hakai_link_date", "year", "depth", "spatial_rep", "location_name_old", "location_name",
"experiment", "temp_surf", "sal_surf", "pH_surf",
"temp_bot", "sal_bot", "pH_bot", "bottom_depth", "vol_filtered",
"lab_notes")
colnames(asv_matrix)[1] <- "SampleID_rep"
#fix experiment column
sample_data$experiment <- str_remove(sample_data$experiment, "repeat-")
sample_data$experiment <- ifelse(sample_data$experiment == 0, "surface", sample_data$experiment)
#merge sample data and matrix
sampledata_asvmatrix <- merge(sample_data, asv_matrix, by = "SampleID_rep")
#remove blanks, make DF of blanks
controls <- filter(sampledata_asvmatrix, sample_type != "biological")
sampledata_asvmatrix <- filter(sampledata_asvmatrix, sample_type == "biological" & experiment != "grid")
b1 <- gather(sampledata_asvmatrix, ASV, count, c(24:1748))
b2 <- gather(controls, ASV, count, c(24:1748))
b3<- b2 %>%
group_by(sample_type, ASV) %>%
summarise(mean_count = mean(count))
ext_blank <- filter(b3, sample_type == "Extraction_blank")
PCRneg_2018 <- filter(b3, sample_type == "PCR_Negative_2018")
b1 <- gather(sampledata_asvmatrix, ASV, count, c(24:1748))
#read data ####
asv_matrix <- read.table("Data/2021_09_20/sequence_table.12S.merged.w_ASV_names.length_var.merged_dataset.txt",
header = T)
sample_data <- read_csv("Data/2021_09_20/Calvert_12S_metadata_manualmods.csv")
sample_data <- read_csv("Data/2021_09_20/Calvert_12S_metadata_manualmods.csv")
sample_data <- read.csv("Data/2021_09_20/Calvert_12S_metadata_manualmods.csv")
View(sample_data)
taxa <- read.delim("Data/2021_09_20/taxonomy_table.12S.NCBI_NT.96sim.txt",
h=TRUE,
fill = TRUE)
#formatting and partitioning ####
#rename columns
colnames(sample_data) <- c("SampleID_rep", "sample_ID", "PCR_rep", "sample_type", "location", "hakai_project", "date",
"hakai_link_date", "year", "depth", "spatial_rep", "location_name_old", "location_name",
"experiment", "temp_surf", "sal_surf", "pH_surf",
"temp_bot", "sal_bot", "pH_bot", "bottom_depth", "vol_filtered",
"lab_notes")
View(sample_data)
colnames(asv_matrix)[1] <- "SampleID_rep"
#fix experiment column
sample_data$experiment <- str_remove(sample_data$experiment, "repeat-")
sample_data$experiment <- ifelse(sample_data$experiment == 0, "surface", sample_data$experiment)
#merge sample data and matrix
sampledata_asvmatrix <- merge(sample_data, asv_matrix, by = "SampleID_rep")
#remove blanks, make DF of blanks
controls <- filter(sampledata_asvmatrix, sample_type != "biological")
sampledata_asvmatrix <- filter(sampledata_asvmatrix, sample_type == "biological" & experiment != "grid")
b1 <- gather(sampledata_asvmatrix, ASV, count, c(24:1748))
b2 <- gather(controls, ASV, count, c(24:1748))
b3<- b2 %>%
group_by(sample_type, ASV) %>%
summarise(mean_count = mean(count))
View(b3)
ext_blank <- filter(b3, sample_type == "Extraction_blank")
PCRneg_2018 <- filter(b3, sample_type == "PCR_Negative_2018")
PCRneg_2019_2020 <- filter(b3, sample_type == "PCR_Negative_2019_2020")
b4 <- merge(b1, ext_blank[c("ASV", "mean_count")], by=c("ASV")) %>% rename("ext_bl_count" = "mean_count")
b2018 <- filter(b4, year == 2018) %>%
merge(., PCRneg_2018[c("ASV", "mean_count")], by=c("ASV")) %>% rename("PCRneg_count" = "mean_count")
b20192020 <- filter(b4, year == 2019 | year == 2020)
b5 <- ifelse(b4$year = 2018,
merge(b4, PCRneg_2018[c("ASV", "mean_count")], by=c("ASV")) ,0)
b5 <- ifelse(b4$year = 2018,
merge(b4, PCRneg_2018[c("ASV", "mean_count")], by=c("ASV")) ,0)
View(b4)
View(PCRneg_2018)
tr <- read_csv("Data/2021_09_20/specandgen_traits_mod.csv")
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
tr <- read_csv("Data/2021_09_20/specandgen_traits_mod.csv")
data <- filter(tr, species == "y" & replicate == 1) %>%
mutate(id = sub("_", " ", id)) %>%
rename(spec = species) %>%
rename(species = id) %>%
mutate(species = tolower(species))
library(rfishbase)
library(tidyverse)
library(here)
library(taxize)
library(readxl)
tr <- read_csv("Data/2021_09_20/specandgen_traits_mod.csv")
